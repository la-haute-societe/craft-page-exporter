Craft.CraftpageexporterExportModal=Garnish.Modal.extend({$spinner:null,requestId:0,init:function(n){Craft.CraftpageexporterExportModal.openInstance=this;let t={};t.onHide=this._onHide.bind(this),this.$container=$('<div id="select-fields-modal" class="modal loading"/>').appendTo(Garnish.$bod),this.base(this.$container,$.extend({resizable:!1},t)),this.$container&&(this.$container.velocity("stop"),this.$container.show().css("opacity",1),this.$shade.velocity("stop"),this.$shade.show().css("opacity",1)),this.loadModalContent(n)},loadModalContent:function(n){this._initSpinner(),this.requestId++,Craft.postActionRequest("craft-page-exporter/default/get-export-modal-content",{entryIds:n,requestId:this.requestId,siteId:this.getSiteId()},function(t,e){if(e==="success")if(t.success){if(t.requestId!=this.requestId)return;this.$container.removeClass("loading"),this.$spinner.remove(),this.loaded=!0,this.$container.append(t.modalHtml),Craft.initUiElements(this.$container)}else alert(t.error),this.hide()}.bind(this))},getSiteId(){let n=$("input[name=siteId]")[0];return n?n.value:Craft.elementIndex&&Craft.elementIndex.siteId?Craft.elementIndex.siteId:Craft.siteId},_initSpinner:function(){this.$container.addClass("loading"),this.$spinner=$('<div class="spinner centeralign"></div>').appendTo(this.$container);var n=this.$container.height()/2-this.$spinner.height()/2+"px",t=this.$container.width()/2-this.$spinner.width()/2+"px";this.$spinner.css({left:t,top:n,position:"absolute"})},_onHide:function(){return Craft.CraftpageexporterExportModal.openInstance=null,this.$shade.remove(),this.destroy()}},{defaultSettings:{}});class a{init(){console.log("Export button component");const t=document.getElementById("action-buttons");if(console.log(t),t===null)return;let e=this.createBtnGroup();t.prepend(e),this.addMenu(e)}createBtnGroup(){let t=document.createElement("div");t.classList.add("btngroup","btngroup--share");let e=document.createElement("a");return e.classList.add("btn","export"),e.innerHTML="Export",e.href=this.getBtnExportLink(),t.appendChild(e),t}addMenu(t){let e=document.createElement("div");e.classList.add("btn","menubtn"),t.appendChild(e);let i=document.createElement("div");i.classList.add("menu");let s=document.createElement("ul");i.appendChild(s);let o=document.createElement("li");s.appendChild(o);let r=document.createElement("a");r.innerHTML="Custom export",r.addEventListener("click",this.onBtnExportClick.bind(this)),o.appendChild(r),this.insertAfter(i,e),new Garnish.MenuBtn(e)}onBtnExportClick(){new Craft.CraftpageexporterExportModal(this.getEntryId())}getBtnExportLink(){return Craft.getUrl(`page-exporter/export/entry-${this.getEntryId()}/site-${this.getSiteId()}`).replace("admin/","")}getEntryId(){return document.getElementById("main-form").elementId.value}getSiteId(){let t=$("input[name=siteId]")[0];return t?t.value:Craft.siteId}insertAfter(t,e){console.log("Insert before",e),e.parentNode.insertBefore(t,e.nextSibling)}}const d=new a;d.init();
//# sourceMappingURL=app.5fffb412.js.map
